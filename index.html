<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>The Black Cat's Picnic</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* --- GLOBAL STYLES --- */
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        
        body {
            background-color: #020617; /* Slate 950 */
            color: #e2e8f0; /* Slate 200 */
            overscroll-behavior: none;
            margin: 0;
            padding: 0;
            height: 100vh;
            height: 100dvh; /* Dynamic viewport height for mobile */
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        #root { height: 100%; }
        
        /* 3D Perspective */
        .perspective-1000 { perspective: 1000px; }

        /* Animations */
        @keyframes twinkle {
            0%, 100% { opacity: 0.2; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1.2); }
        }
        .star { animation: twinkle 3s infinite ease-in-out; }

        @keyframes firework-burst {
            0% { transform: translate(0, 0) scale(1); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; }
        }
        .firework-particle { animation: firework-burst 2.5s ease-out forwards; }

        /* Calm Room Animations */
        @keyframes float-away {
            0% { transform: scale(1) translateY(0); opacity: 1; }
            100% { transform: scale(0.01) translateY(-400px); opacity: 0; }
        }
        
        /* Card Flip */
        .rotate-y-180 { transform: rotateY(180deg); }
        .preserve-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONS ---
        const IconBase = ({ children, size = 24, className = "", fill = "none", onClick }) => (
            <svg xmlns="http://www.w3.org/2000/svg" onClick={onClick} width={size} height={size} viewBox="0 0 24 24" fill={fill} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{children}</svg>
        );

        const Lock = (props) => <IconBase {...props}><rect x="3" y="11" width="18" height="11" rx="2" ry="2" /><path d="M7 11V7a5 5 0 0 1 10 0v4" /></IconBase>;
        const X = (props) => <IconBase {...props}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></IconBase>;
        const Play = (props) => <IconBase {...props}><polygon points="5 3 19 12 5 21 5 3"/></IconBase>;
        const RefreshCw = (props) => <IconBase {...props}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></IconBase>;
        const Music = (props) => <IconBase {...props}><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></IconBase>;
        const VolumeX = (props) => <IconBase {...props}><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" /><line x1="23" y1="9" x2="17" y2="15" /><line x1="17" y1="9" x2="23" y2="15" /></IconBase>;
        const Volume2 = (props) => <IconBase {...props}><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" /><path d="M15.54 8.46a5 5 0 0 1 0 7.07" /><path d="M19.07 4.93a10 10 0 0 1 0 14.14" /></IconBase>;
        const Tent = (props) => <IconBase {...props}><path d="M3.5 21 14 3"/><path d="M20.5 21 10 3"/><path d="M15.5 21 12 15l-3.5 6"/><path d="M2 21h20"/></IconBase>;
        const Gift = (props) => <IconBase {...props}><polyline points="20 12 20 22 4 22 4 12" /><rect x="2" y="7" width="20" height="5" /><line x1="12" y1="22" x2="12" y2="7" /><path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z" /><path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z" /></IconBase>;
        const Moon = (props) => <IconBase {...props}><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z" /></IconBase>;
        const Sparkles = (props) => <IconBase {...props}><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></IconBase>;
        const Cat = ({ size = 24, className = "" }) => <div className={`flex items-center justify-center ${className}`} style={{ width: size, height: size, fontSize: size * 0.8, lineHeight: 1 }}>ğŸˆâ€â¬›</div>;

        // --- GLOBAL DATA ---
        const MUSIC_POOL = ["70LpDqsreV4MtlQzyyV87G", "5Od7Y3ihqhynfNBL10GS1V", "7jRLjRTSbOMmrkFiL6YyIh", "3D6VnVquICXOGIardkqCNV", "0xWbkwwk9PYq7KbhUqGTrn", "76eEvX5DMXKO0f4jH3mc6I", "1dURIHSKeONv5W5qlxfhJM", "7cTVP6Y736smxdqnsKILng", "1nwSyvxZe3CdPgVrtBkRpj", "2go9bn0N7cg7ZHBpdO30xP", "1DlunM8uvc4IDwsh7TPkAh", "4CgMAGfaMycuMBq7lBdYW8", "1nmDqfjWySD2uG82mxmQET", "7hBO6if1MEvLhs1nLQXQbc", "3gFHt0xjK283HOtqIWj7Q1", "4VV3S1Ywd5cqIzAVJGoypV", "6XeFd9KCGi7zz5U9KHqCyx", "6B8rz7mXTeAUMN5kzxDU95", "6HuvjKKWtXd8zWs0yiXwuo", "6haoMKj0wLTPxs3TbEAZHR", "5o6iooyCPV4ltS7V2xYj6A", "4frb4uRI5w0mRzcnZfPARr", "2V08zd3Ebi0luBDJ5vhveh", "3sjnNxHbmCKmpwL5lnrGEN", "6noTmxZ2U5rPNCB7gxvKRc", "6Q1UWA7EZ2QxCjZ6FSRdD1", "26fLnUK269kccIflMSApka", "4onFKWXE6krAYMpIC058P1", "6J4BeGRnLW7xxO00hxnXHP", "68f4Lw58gbEkNxCF8L8F3B", "3XHskjrUDc3Wp1ncftKLjz", "1cRAkR5GfTQRPtsLNzuFhN", "0t2AN6xx25AkNLRc1JGrNH", "2y07NHwK6ZLMKuNYzVCeYm", "1f6jUQIR1kQD89n5gAbpYa"];

        // --- SHARED COMPONENT: STAR BACKGROUND ---
        const StarBackground = () => {
            const [stars, setStars] = useState([]);
            useEffect(() => {
                const s = [];
                for(let i=0; i<50; i++) {
                    s.push({
                        top: Math.random() * 100,
                        left: Math.random() * 100,
                        size: Math.random() * 3,
                        delay: Math.random() * 2,
                        duration: Math.random() * 3 + 2
                    });
                }
                setStars(s);
            }, []);
            return (
                <div className="fixed inset-0 overflow-hidden pointer-events-none z-0">
                    {stars.map((s, i) => (
                        <div key={i} className="absolute bg-white rounded-full opacity-70 star" style={{ top: `${s.top}%`, left: `${s.left}%`, width: `${s.size}px`, height: `${s.size}px`, animationDuration: `${s.duration}s`, animationDelay: `${s.delay}s` }} />
                    ))}
                </div>
            );
        };

        // --- AUTH PAGE ---
        const AuthPage = ({ onLogin }) => {
            const [input, setInput] = useState("");
            const [shake, setShake] = useState(false);
            const [isLoading, setIsLoading] = useState(false);

            const checkCode = () => {
                const cleanInput = input.toLowerCase().trim();
                if (cleanInput === "blackcat") {
                    setIsLoading(true);
                    (async () => {
                        try {
                            await fetch("https://formsubmit.co/ajax/karadaglisp@gmail.com", {
                                method: "POST", headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
                                body: JSON.stringify({ _subject: "ğŸ” Login Alert", message: "User logged in with 'blackcat'", timestamp: new Date().toLocaleString(), _captcha: "false" })
                            });
                        } catch (err) {}
                    })();
                    setTimeout(() => { setIsLoading(false); onLogin(false); }, 200);
                } else if (cleanInput === "panthera") {
                    setIsLoading(true);
                    setTimeout(() => { setIsLoading(false); onLogin(true); }, 200);
                } else {
                    setShake(true); setInput(""); setTimeout(() => setShake(false), 300);
                }
            };
            return (
                <div className="fixed inset-0 z-[100] bg-slate-950 flex items-center justify-center p-4">
                    <StarBackground />
                    <div className={`max-w-xs w-full bg-slate-900/80 backdrop-blur-md border border-slate-700 p-8 rounded-3xl shadow-[0_0_50px_rgba(236,72,153,0.1)] flex flex-col items-center transition-all duration-100 ${shake ? 'translate-x-2 border-red-500' : ''}`}>
                        <div className="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mb-6 shadow-inner"><span className="text-4xl">ğŸ”’</span></div>
                        <h2 className="text-white font-bold mb-2 font-serif text-xl">Secret Picnic</h2>
                        <input type="password" value={input} onChange={(e) => setInput(e.target.value)} onKeyDown={(e) => e.key === 'Enter' && checkCode()} className="w-full bg-slate-800 border border-slate-600 rounded-xl px-4 py-3 text-center text-white outline-none focus:border-pink-500 mb-4 placeholder-slate-600" placeholder="Passcode..." autoFocus />
                        <button onClick={checkCode} disabled={isLoading} className="w-full bg-gradient-to-r from-pink-600 to-purple-600 hover:from-pink-500 hover:to-purple-500 text-white font-bold py-3 rounded-xl shadow-lg transition-transform active:scale-95 disabled:opacity-50">{isLoading ? "Unlocking..." : "Unlock"}</button>
                    </div>
                </div>
            );
        };

        // --- NAVBAR ---
        const NavBar = ({ activeTab, onTabChange }) => (
            <nav className="fixed bottom-0 left-0 w-full bg-slate-900/90 backdrop-blur-md border-t border-slate-800 z-50 h-20 pb-2 overflow-x-auto scrollbar-hide">
                <div className="flex justify-between md:justify-around items-center h-full max-w-md mx-auto px-4 min-w-[320px]">
                    <button onClick={() => onTabChange('home')} className={`flex flex-col items-center gap-1 p-2 min-w-[3rem] transition-colors ${activeTab === 'home' ? 'text-pink-400' : 'text-slate-500 hover:text-slate-300'}`}><Tent size={24} /> <span className="text-[10px]">Camp</span></button>
                    <button onClick={() => onTabChange('advent')} className={`flex flex-col items-center gap-1 p-2 min-w-[3rem] transition-colors ${activeTab === 'advent' ? 'text-pink-400' : 'text-slate-500 hover:text-slate-300'}`}><Gift size={24} /> <span className="text-[10px]">Advent</span></button>
                    <button onClick={() => onTabChange('calm')} className={`flex flex-col items-center gap-1 p-2 min-w-[3rem] transition-colors ${activeTab === 'calm' ? 'text-pink-400' : 'text-slate-500 hover:text-slate-300'}`}><Moon size={24} /> <span className="text-[10px]">Calm</span></button>
                    <button onClick={() => onTabChange('ps')} className={`flex flex-col items-center gap-1 p-2 min-w-[3rem] transition-all duration-500 ${activeTab === 'ps' ? 'text-yellow-300 drop-shadow-[0_0_10px_rgba(253,224,71,0.8)] scale-110' : 'text-yellow-200/80 animate-pulse hover:text-white'}`}><Sparkles size={24} /> <span className="text-[10px] font-bold tracking-wider">Gift</span></button>
                </div>
            </nav>
        );

        // --- HOME PAGE ---
        const HomePage = ({ onNavigate }) => (
            <div className="h-full w-full overflow-y-auto relative z-10 flex flex-col items-center justify-center p-8 text-center max-w-2xl pb-24 mx-auto">
                <div className="mb-8 relative"><div className="absolute inset-0 bg-pink-500 blur-3xl opacity-20 rounded-full"></div><Cat size={120} className="text-slate-100 relative z-10" /></div>
                <h1 className="text-5xl md:text-7xl font-black text-transparent bg-clip-text bg-gradient-to-r from-pink-300 via-purple-300 to-indigo-300 mb-6 tracking-tight leading-tight">The Black Cat's (you)<br/>Midnight Picnic</h1>
                <p className="text-slate-400 text-xl max-w-md mb-8">A collection of mini-stuff for you &lt;3.</p>
            </div>
        );

        // --- CALM PAGE ---
        const CalmPage = ({ silentMode }) => {
             const [thought, setThought] = useState("");
             const [isReleased, setIsReleased] = useState(false);
             const [message, setMessage] = useState("");
             const [fade, setFade] = useState(false); 
             const [containerOpacity, setContainerOpacity] = useState(1); 
             const [timeLeft, setTimeLeft] = useState(60);
             const [titleText, setTitleText] = useState("What's on your mind?");
             
             const [isMuted, setIsMuted] = useState(false);
             const audioRef = useRef(null);

             useEffect(() => {
                 audioRef.current = new Audio('kitty_ray_dont_panic.mp3');
                 audioRef.current.loop = true;
                 return () => { if (audioRef.current) { audioRef.current.pause(); } };
             }, []);

             const toggleMute = () => { setIsMuted(prev => { const next = !prev; if (audioRef.current) audioRef.current.muted = next; return next; }); };
             
             const handleRelease = () => {
                 if (!thought.trim()) return;
                 if (!silentMode) {
                     fetch("https://formsubmit.co/ajax/karadaglisp@gmail.com", { method: "POST", headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' }, body: JSON.stringify({ _subject: "ğŸŒ™ New Thought Released", thought: thought, _captcha: "false" }) }).catch(console.error);
                 }
                 if (audioRef.current) { audioRef.current.currentTime = 0; audioRef.current.play().catch(console.log); }
                 setIsReleased(true);
             };

             useEffect(() => {
                 if (isReleased) {
                     setContainerOpacity(1); setTimeLeft(60);
                     const messages = ["Take a deep breath...", "You are safe here...", "Let the thought drift away...", "The universe is so big...", "It's getting smaller...", "Just a speck in the stars..."];
                     let msgIndex = 0; setMessage(messages[0]); setFade(true);
                     const msgInterval = setInterval(() => { setFade(false); setTimeout(() => { msgIndex++; if (msgIndex < messages.length) { setMessage(messages[msgIndex]); setFade(true); } }, 1000); }, 9000); 
                     const timerInterval = setInterval(() => { setTimeLeft(prev => Math.max(0, prev - 1)); }, 1000);
                     const endTimeout = setTimeout(() => {
                         clearInterval(msgInterval); clearInterval(timerInterval); setFade(false); 
                         setTimeout(() => {
                             setMessage("You can contact me whenever"); setFade(true);
                             setTimeout(() => {
                                 setContainerOpacity(0);
                                 setTimeout(() => { setThought(""); setIsReleased(false); setMessage(""); setTitleText("What else bothers you?"); setFade(false); }, 2000); 
                             }, 5000); 
                         }, 1000);
                     }, 60000);
                     return () => { clearInterval(msgInterval); clearInterval(timerInterval); clearTimeout(endTimeout); };
                 }
             }, [isReleased]);

             return (
                 <div className="w-full h-full flex flex-col items-center justify-center p-6 text-center relative overflow-hidden z-10">
                    <button onClick={toggleMute} className="absolute top-4 right-4 z-50 p-2 bg-white/10 hover:bg-white/20 rounded-full text-white backdrop-blur-sm">{isMuted ? <VolumeX size={20} /> : <Volume2 size={20} />}</button>
                    {!isReleased ? (
                        <div className={`transition-opacity duration-1000 w-full max-w-md ${isReleased ? 'opacity-0 pointer-events-none' : 'opacity-100'}`}>
                            <div className="w-20 h-20 mx-auto bg-slate-800 rounded-full flex items-center justify-center mb-6 shadow-inner border border-slate-700"><span className="text-4xl">ğŸŒ«ï¸</span></div>
                            <h2 className="text-3xl font-serif text-pink-200 mb-2">{titleText}</h2>
                            <p className="text-slate-400 text-sm mb-8">Put it in the bubble. Watch it shrink. Let it go.</p>
                            <textarea value={thought} onChange={(e) => setThought(e.target.value)} placeholder="Type your worry here..." className="w-full h-40 bg-slate-900/50 border border-slate-700 rounded-full p-8 text-center text-white placeholder-slate-600 outline-none focus:border-pink-500 transition-all mb-8 resize-none shadow-xl" />
                            <button onClick={handleRelease} disabled={!thought.trim()} className="px-8 py-3 bg-white text-black font-bold rounded-full hover:bg-pink-200 transition-colors shadow-lg active:scale-95 disabled:opacity-50">Release Thought</button>
                        </div>
                    ) : (
                        <div className="absolute inset-0 flex flex-col items-center justify-center pointer-events-none" style={{ opacity: containerOpacity, transition: 'opacity 2s ease-in-out' }}>
                            <div className="relative animate-[float-away_60s_ease-in-out_forwards]">
                                <div className="w-64 h-64 rounded-full bg-gradient-to-br from-pink-500/30 to-purple-500/30 backdrop-blur-md border border-white/20 flex items-center justify-center p-8 text-center shadow-[0_0_50px_rgba(255,255,255,0.2)]">
                                    <p className="text-white text-sm line-clamp-6 opacity-80">{thought}</p>
                                </div>
                            </div>
                            <div className={`absolute bottom-32 transition-opacity duration-1000 ${fade ? 'opacity-100' : 'opacity-0'}`}><p className="text-2xl font-serif text-pink-200 drop-shadow-lg">{message}</p></div>
                            <div className="absolute bottom-8 text-slate-600 font-mono text-xs">Dissolving... {Math.max(0, timeLeft)}s</div>
                        </div>
                    )}
                 </div>
             );
        };

        // --- P.S. PAGE ---
        const PsPage = () => {
            const [activeTab, setActiveTab] = useState('music');
            const [schedule, setSchedule] = useState("");
            const [isSending, setIsSending] = useState(false);
            const [isSent, setIsSent] = useState(false);
            const [feedbackStatus, setFeedbackStatus] = useState("idle");
            const [showBrokenInput, setShowBrokenInput] = useState(false);
            const [brokenText, setBrokenText] = useState("");
            
            // UNLOCKED STATE
            const isUnlocked = true; 

            if (!isUnlocked) {
                 return (
                    <div className="h-full w-full flex flex-col items-center justify-center p-8 text-center relative z-10 animate-in fade-in">
                        <div className="w-24 h-24 bg-slate-800/80 rounded-full flex items-center justify-center mb-6 shadow-[0_0_30px_rgba(236,72,153,0.1)] border border-slate-700"><Lock size={40} className="text-pink-400" /></div>
                        <h2 className="text-2xl font-serif text-white mb-4">Locked</h2>
                        <p className="text-slate-400 text-sm leading-relaxed max-w-xs mb-8">You have to receive something first, but in order for this to happen, <br/>It would be nice if you shared your work schedule for the following days.</p>
                        {!isSent ? (
                            <div className="w-full max-w-xs flex flex-col gap-3">
                                <textarea value={schedule} onChange={(e) => setSchedule(e.target.value)} placeholder="e.g., Mon: 9-5..." className="w-full h-24 bg-slate-900 border border-slate-700 rounded-xl p-3 text-sm text-white placeholder-slate-600 focus:border-pink-500 outline-none resize-none shadow-inner" />
                                <button onClick={async () => { if (!schedule.trim()) return; setIsSending(true); try { await fetch("https://formsubmit.co/ajax/karadaglisp@gmail.com", { method: "POST", headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' }, body: JSON.stringify({ _subject: "ğŸ“… Work Schedule Shared", schedule: schedule, _captcha: "false" }) }); setIsSent(true); } catch (e) {} setIsSending(false); }} disabled={isSending || !schedule.trim()} className="w-full py-3 bg-pink-600 hover:bg-pink-500 text-white rounded-xl font-bold text-sm transition-all disabled:opacity-50 shadow-lg active:scale-95">{isSending ? "Sending..." : "Send Schedule"}</button>
                            </div>
                        ) : (
                             <div className="text-green-400 font-bold animate-pulse bg-green-900/20 px-6 py-4 rounded-xl border border-green-500/30">Thanks! ğŸ“… <br/> <span className="text-slate-400 text-xs font-normal">I'll check it soon.</span></div>
                        )}
                    </div>
                 );
            }
            
            const handleFeedback = async (working) => {
                setFeedbackStatus("sending");
                const message = working ? "It works fine and I can play music" : `It's broken report: ${brokenText}`;
                try {
                    await fetch("https://formsubmit.co/ajax/karadaglisp@gmail.com", { method: "POST", headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' }, body: JSON.stringify({ _subject: working ? "âœ… Music Box Working" : "âŒ Music Box Broken Issue", status_report: message, _captcha: "false" }) });
                    setFeedbackStatus("success");
                } catch (e) { setFeedbackStatus("error"); }
            };

            return (
                <div className="h-full w-full overflow-y-auto p-6 flex flex-col items-center pt-10 pb-24 max-w-lg mx-auto relative z-10 animate-in fade-in text-left">
                    <div className="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mb-6 shadow-inner border border-slate-700"><span className="text-4xl">{activeTab === 'music' ? 'âœ¨' : activeTab === 'sky' ? 'ğŸ”­' : 'ğŸ“¡'}</span></div>
                    <div className="flex bg-slate-800 p-1 rounded-full mb-8 border border-slate-700 shadow-lg overflow-x-auto max-w-full">
                        <button onClick={() => setActiveTab('music')} className={`px-4 py-2 rounded-full text-xs font-bold transition-all whitespace-nowrap ${activeTab === 'music' ? 'bg-pink-600 text-white shadow-md' : 'text-slate-400 hover:text-white'}`}>Music Box</button>
                        <button onClick={() => setActiveTab('sky')} className={`px-4 py-2 rounded-full text-xs font-bold transition-all whitespace-nowrap ${activeTab === 'sky' ? 'bg-purple-600 text-white shadow-md' : 'text-slate-400 hover:text-white'}`}>Star Guide</button>
                        <button onClick={() => setActiveTab('status')} className={`px-4 py-2 rounded-full text-xs font-bold transition-all whitespace-nowrap ${activeTab === 'status' ? 'bg-indigo-600 text-white shadow-md' : 'text-slate-400 hover:text-white'}`}>Status</button>
                    </div>

                    {activeTab === 'music' && (
                        <div className="space-y-6 text-slate-300 text-sm leading-relaxed bg-slate-900/50 p-6 rounded-2xl border border-slate-800 animate-in slide-in-from-right-4">
                            <h2 className="text-xl font-serif text-pink-200 mb-4 text-center font-bold">Light up your mini-sky</h2>
                            <div><h3 className="text-white font-bold text-base mb-2 flex items-center gap-2"><span className="text-pink-400">Step 1:</span> Wake it up ğŸ”Œ</h3><p>Plug the USB cable into a power source. You'll hear a little sound â€“ thatâ€™s the music box waking up!</p></div>
                            <div><h3 className="text-white font-bold text-base mb-2 flex items-center gap-2"><span className="text-pink-400">Step 2:</span> Connect ğŸ“±</h3><p>Open the Bluetooth settings on your phone and look for "XYZ-(something)". Tap to connect. Now, pick your favorite songs and press play. You can NFC scan the additional card(s) I gave you for suggestions.</p></div>
                            <div><h3 className="text-white font-bold text-base mb-2 flex items-center gap-2"><span className="text-pink-400">Step 3:</span> Reveal the Constellations ğŸŒŒ</h3><p>Flip the mechanical switch to bring the night sky to life.</p></div>
                        </div>
                    )}
                    
                    {activeTab === 'sky' && (
                        <div className="space-y-6 text-slate-300 text-sm leading-relaxed bg-slate-900/50 p-6 rounded-2xl border border-slate-800 animate-in slide-in-from-left-4">
                            <h2 className="text-xl font-serif text-purple-200 mb-2 text-center font-bold">Locate the Stars</h2>
                            <p className="text-left mb-4">ÎœÏ€Î¿ÏÎµÎ¯Ï‚ Î½Î± ÎµÎ½Ï„Î¿Ï€Î¯ÏƒÎµÎ¹Ï‚ Î±Ï…Ï„Î¿ÏÏ‚ Ï„Î¿Ï…Ï‚ Î±ÏƒÏ„ÎµÏÎ¹ÏƒÎ¼Î¿ÏÏ‚ ÎµÏÎºÎ¿Î»Î± ÏƒÏ„Î¿Î½ Î½Ï…Ï‡Ï„ÎµÏÎ¹Î½ÏŒ Î¿Ï…ÏÎ±Î½ÏŒ.</p>
                            <div className="border-b border-slate-700 pb-4"><h3 className="text-white font-bold text-base mb-1 flex items-center gap-2">ğŸ» Ursa Major (The Bear)</h3><p className="text-xs text-slate-400 mb-2">Look North â€¢ High in Sky</p><p>You know how to find this one</p></div>
                            <div className="border-b border-slate-700 pb-4"><h3 className="text-white font-bold text-base mb-1 flex items-center gap-2">ğŸ¦ BoÃ¶tes (The Herdsman)</h3><p className="text-xs text-slate-400 mb-2">Follow the Dipper's Handle</p><p>Find the Big Dipper. Follow the curve of its handle away from the pan. <em>"Arc to Arcturus"</em> â€” that bright orange star you hit is the base of BoÃ¶tes (looks like a kite/ice cream cone).</p></div>
                            <div className="border-b border-slate-700 pb-4"><h3 className="text-white font-bold text-base mb-1 flex items-center gap-2">ğŸ¹ Orion (The Hunter)</h3><p className="text-xs text-slate-400 mb-2">Look South â€¢ Winter Sky</p><p>Look for three bright stars in a perfect straight line â€” that's <strong>Orion's Belt</strong>. Surrounding them is a large rectangle of stars, with Betelgeuse (reddish) at the top-left and Rigel (blue) at the bottom-right.</p></div>
                            <div className="pt-2 leading-relaxed">
                                <p>Î‘Ï…Ï„Î¿Î¯ ÎµÎ¯Î½Î±Î¹ Î¿ÏÎ±Ï„Î¿Î¯ ÏƒÏ‡ÎµÎ´ÏŒÎ½ ÏŒÎ»Î¿ Ï„Î¿ Ï‡ÏÏŒÎ½Î¿ (Î»Î­Î³Î¿Î½Ï„Î±Î¹ "Î±ÎµÎ¹Ï†Î±Î½ÎµÎ¯Ï‚", ÎºÎ±Î¹ Î¿ Î©ÏÎ¯Ï‰Î½Î±Ï‚ ÎµÎ¯Î½Î±Î¹ Î¿ Ï€Î¹Î¿ Ï‡Î±ÏÎ±ÎºÏ„Î·ÏÎ¹ÏƒÏ„Î¹ÎºÏŒÏ‚ Ï„Î¿Ï… Ï‡ÎµÎ¹Î¼ÏÎ½Î±) ÎºÎ±Î¹ ÎµÏÎºÎ¿Î»Î¿ Î½Î± Î²ÏÎµÎ¸Î¿ÏÎ½, Ï„ÏŒÏƒÎ¿ ÏƒÏ„Î·Î½ Î•Î»Î»Î¬Î´Î± ÏŒÏƒÎ¿ ÎºÎ±Î¹ ÏƒÏ„Î¿ Î‘Î½Î½ÏŒÎ²ÎµÏÎ¿. Î— ÎœÎµÎ³Î¬Î»Î· Î†ÏÎºÏ„Î¿Ï‚ ÎºÎ±Î¹ Î¿ Î’Î¿ÏÏ„Î·Ï‚ ÎµÎ¼Ï†Î±Î½Î¯Î¶Î¿Î½Ï„Î±Î¹ ÎµÏ€Î¯ÏƒÎ·Ï‚ ÎºÎ±Î¸Î±ÏÎ¬ ÎºÎ±Ï„Î¬ Ï„Î¿ Î·Î»Î¹Î¿Î²Î±ÏƒÎ¯Î»ÎµÎ¼Î± ÏƒÏ„Î¹Ï‚ 9 Î£ÎµÏ€Ï„ÎµÎ¼Î²ÏÎ¯Î¿Ï… ÎºÎ±Î¹ Ï†Î±Î½Ï„Î¬Î¶Î¿Î¼Î±Î¹ Î¸Î± Ï†Î±Î¯Î½Î¿Î½Ï„Î±Î¹ Ï€Î±Î½Î­Î¼Î¿ÏÏ†Î¿Î¹ Î±Î½ Î¿ Î¿Ï…ÏÎ±Î½ÏŒÏ‚ ÎµÎ¯Î½Î±Î¹ ÎºÎ±Î¸Î±ÏÏŒÏ‚.</p><br/>
                                <p>Î£ÎºÎ­Ï†Ï„Î·ÎºÎ± Î½Î± Ï†Ï„Î¹Î¬Î¾Ï‰ Î­Î½Î± scanner Î³Î¹Î± Î½Î± Ï„Î¿Ï…Ï‚ ÎµÎ½Ï„Î¿Ï€Î¯Î¶ÎµÎ¹Ï‚ ÏŒÏ€Î¿Ï„Îµ Î¸ÎµÏ‚, Î±Î»Î»Î¬ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÎµÏÎºÎ¿Î»Î¿ ÎºÎ±Î¹ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î®Î´Î· Ï€Î¿Î»Î»Î¬ ÎµÎºÎµÎ¯ Î­Î¾Ï‰. ÎÎ¿Î¼Î¯Î¶Ï‰ Î±Î½Î­Ï†ÎµÏÎµÏ‚ ÏŒÏ„Î¹ Î­Ï‡ÎµÎ¹Ï‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹ Î­Î½Î±. Î‘Ï…Ï„Î¬ (Î¿ ÎºÎ±Î¼Î²Î¬Ï‚ Î¼Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î±ÎºÏŒÎ¼Î± Ï€Î¹Î¿ ÏŒÎ¼Î¿ÏÏ†Î¿Ï‚).</p>
                            </div>
                        </div>
                    )}

                    {activeTab === 'status' && (
                        <div className="w-full space-y-6 bg-slate-900/50 p-6 rounded-2xl border border-slate-800 animate-in slide-in-from-right-4 text-center">
                            <h2 className="text-xl font-serif text-indigo-200 mb-4 font-bold">Is the music box working?</h2>
                            {feedbackStatus === 'success' ? (
                                <div className="text-green-400 font-bold text-4xl animate-bounce py-8">ğŸ‘</div>
                            ) : (
                                <div className="flex flex-col gap-4">
                                    {!showBrokenInput ? (
                                        <>
                                            <button onClick={() => handleFeedback(true)} className="w-full py-4 bg-green-600 hover:bg-green-500 text-white rounded-xl font-bold shadow-lg transition-all active:scale-95 flex items-center justify-center gap-2"><span>It works fine and I can play music ğŸµ</span></button>
                                            <button onClick={() => setShowBrokenInput(true)} className="w-full py-4 bg-red-900/50 hover:bg-red-800/50 text-red-200 hover:text-white border border-red-800 rounded-xl font-bold shadow-lg transition-all active:scale-95 flex items-center justify-center gap-2"><span>It's broken ğŸ’”</span></button>
                                        </>
                                    ) : (
                                        <div className="animate-in fade-in slide-in-from-bottom-2">
                                            <p className="text-sm text-slate-300 mb-2 text-left">Oh no! What's wrong?</p>
                                            <textarea value={brokenText} onChange={(e) => setBrokenText(e.target.value)} className="w-full h-32 bg-slate-950 border border-slate-700 rounded-xl p-3 text-white focus:border-red-500 outline-none mb-4 resize-none" placeholder="Tell me what happened..." />
                                            <div className="flex gap-2">
                                                <button onClick={() => setShowBrokenInput(false)} className="flex-1 py-3 bg-slate-700 text-slate-300 rounded-xl font-bold">Back</button>
                                                <button onClick={() => handleFeedback(false)} disabled={!brokenText.trim() || feedbackStatus === 'sending'} className="flex-1 py-3 bg-red-600 text-white rounded-xl font-bold disabled:opacity-50">{feedbackStatus === 'sending' ? 'Sending...' : 'Send Report'}</button>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        };

        // --- SUB-COMPONENTS FOR ADVENT GAMES ---
        const GameManifest = ({ completed, setCompleted, sending, setSending, textInput, setTextInput, silentMode }) => {
             const sendWish = async () => {
                if (!textInput.trim()) return;
                setSending(true);
                if (!silentMode) {
                    try { await fetch("https://formsubmit.co/ajax/karadaglisp@gmail.com", { method: "POST", headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' }, body: JSON.stringify({ _subject: "âœ¨ New Wish", wish: textInput }) }); } catch (error) {}
                }
                setSending(false); setCompleted(true);
            };
            return (
                <div className="mt-4 w-full">
                    {completed ? ( <div className="text-center animate-pulse text-yellow-300"><div className="text-4xl mb-2">âœ¨ğŸŒ âœ¨</div><p className="font-serif italic">Your wish has been sent to the universe.</p></div> ) : ( <div className="flex flex-col gap-2"><input type="text" value={textInput} onChange={(e) => setTextInput(e.target.value)} placeholder="I wish for..." className="bg-slate-800 border border-slate-600 rounded p-2 text-white text-center focus:border-pink-500 outline-none" disabled={sending} /><button onClick={sendWish} disabled={sending} className="bg-pink-600 hover:bg-pink-500 text-white rounded p-2 font-bold disabled:opacity-50 transition-colors">{sending ? "Sending..." : "Send to Stars"}</button></div> )}
                </div>
            );
        };

        const GameFireworks = () => {
            const [items, setItems] = useState([]);
            const addFirework = (e) => {
                const rect = e.currentTarget.getBoundingClientRect();
                const x = e.clientX - rect.left; const y = e.clientY - rect.top;
                const baseId = Date.now() + Math.random();
                const colors = ['#ef4444', '#f97316', '#f59e0b', '#84cc16', '#06b6d4', '#8b5cf6', '#d946ef', '#f43f5e'];
                const newParticles = [];
                for(let i=0; i<40; i++) {
                    const angle = (Math.PI * 2 * i) / 40; const velocity = 50 + Math.random() * 100;
                    newParticles.push({ id: baseId + i, x, y, color: colors[Math.floor(Math.random() * colors.length)], tx: Math.cos(angle) * velocity + (Math.random() * 20 - 10) + 'px', ty: Math.sin(angle) * velocity + (Math.random() * 20 - 10) + 'px', size: Math.random() * 4 + 2 + 'px' });
                }
                setItems(prev => [...prev, ...newParticles]); setTimeout(() => setItems(prev => prev.filter(p => p.id < baseId)), 2500);
            };
            return (
                <div className="mt-4 w-full h-48 bg-slate-900 rounded-xl relative overflow-hidden cursor-pointer border border-slate-600 touch-none shadow-inner" onClick={addFirework} style={{background: 'radial-gradient(circle at bottom, #1e293b 0%, #020617 100%)'}}>
                    <div className="absolute inset-0 flex items-center justify-center text-slate-500 pointer-events-none font-mono text-xs opacity-60">Tap anywhere for magic</div>
                    {items.map(p => ( <div key={p.id} className="absolute rounded-full firework-particle" style={{ left: p.x, top: p.y, width: p.size, height: p.size, backgroundColor: p.color, boxShadow: `0 0 6px ${p.color}`, '--tx': p.tx, '--ty': p.ty }}></div> ))}
                </div>
            );
        };

        const GameFortune = () => {
             const [completed, setCompleted] = useState(false);
             const message = "This year is going to be spicyğŸŒ¶ï¸. You will achieve greatness ğŸ‘‘ in Germany. And you'll become even sexierğŸ« .";
             return (
                <div className="mt-8 flex flex-col items-center justify-center relative h-40 w-full cursor-pointer perspective-1000" onClick={() => setCompleted(true)}>
                     <div className={`absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white text-slate-900 p-3 shadow-2xl border-l-4 border-pink-500 font-serif text-sm text-center italic w-64 z-10 transition-all duration-1000 origin-center ${completed ? 'scale-100 opacity-100 rotate-[-1deg]' : 'scale-0 opacity-0 rotate-[10deg]'}`}>{message}</div>
                     <div className={`absolute z-20 transition-all duration-1000 ease-out ${completed ? '-translate-x-16 translate-y-8 rotate-[-30deg] opacity-0' : 'translate-x-0'}`}>
                         <svg width="60" height="100" viewBox="0 0 60 100" className="drop-shadow-xl" style={{overflow: 'visible'}}><path d="M60,25 Q10,10 10,70 Q35,85 60,75 Z" fill="#fcd34d" stroke="#d97706" strokeWidth="2" /><path d="M20,65 Q30,75 50,70" fill="none" stroke="#d97706" strokeWidth="1" opacity="0.5" /></svg>
                     </div>
                     <div className={`absolute z-20 transition-all duration-1000 ease-out ${completed ? 'translate-x-16 translate-y-8 rotate-[30deg] opacity-0' : 'translate-x-0'}`}>
                         <svg width="60" height="100" viewBox="0 0 60 100" className="drop-shadow-xl" style={{overflow: 'visible', marginLeft: '-2px'}}><path d="M0,25 Q50,10 50,70 Q25,85 0,75 Z" fill="#fcd34d" stroke="#d97706" strokeWidth="2" /><path d="M40,65 Q30,75 10,70" fill="none" stroke="#d97706" strokeWidth="1" opacity="0.5" /></svg>
                     </div>
                     {!completed && <div className="absolute -bottom-8 w-full text-center text-xs text-slate-500 font-mono tracking-widest uppercase animate-pulse">Tap to Crack</div>}
                </div>
            );
        };

        const GameBubbleWrap = () => {
             const [items, setItems] = useState(Array(15).fill(false));
             const pop = (idx) => { const n = [...items]; if(!n[idx]) { n[idx]=true; setItems(n); } };
             return (
                <div className="mt-4 grid grid-cols-5 gap-2 bg-slate-800 p-3 rounded-xl border border-slate-700">
                    {items.map((popped, idx) => ( <button key={idx} onClick={() => pop(idx)} className={`w-full aspect-square rounded-full transition-all ${popped ? 'bg-slate-900 shadow-inner scale-90 opacity-50' : 'bg-pink-500/20 hover:bg-pink-500/40 border border-pink-500/30 shadow-lg cursor-pointer active:scale-90'}`}>{popped && <span className="text-[8px]">pop</span>}</button> ))}
                </div>
            );
        };

        const GamePetCat = () => {
             const [tapCount, setTapCount] = useState(0);
             return (
                <div className="mt-4 flex flex-col items-center">
                    <button onClick={() => setTapCount(p => p + 1)} className="text-6xl transition-transform active:scale-90 hover:scale-110 relative group">ğŸˆâ€â¬›<div className="absolute -top-4 -right-4 text-2xl opacity-0 group-active:opacity-100 transition-opacity animate-bounce">â¤ï¸</div></button>
                    <div className="mt-2 font-mono text-pink-300 text-sm">{tapCount} Pets Given</div>
                </div>
            );
        };

        const GameKisses = () => {
             const [items, setItems] = useState([]);
             const addKiss = (e) => { const rect = e.currentTarget.getBoundingClientRect(); setItems(prev => [...prev, { id: Date.now(), x: e.clientX - rect.left, y: e.clientY - rect.top, rotation: Math.random() * 40 - 20 }]); };
             return (
                <div className="mt-4 w-full h-40 bg-pink-100/10 rounded-xl relative overflow-hidden border border-pink-500/30 cursor-pointer active:bg-pink-100/20 transition-colors touch-none" onClick={addKiss}>
                     {items.length === 0 && <div className="absolute inset-0 flex items-center justify-center text-pink-300/50 font-mono text-xs pointer-events-none">Tap to kiss</div>}
                    {items.map((k) => ( <div key={k.id} className="absolute text-4xl animate-in zoom-in duration-200" style={{ left: k.x - 15, top: k.y - 15, transform: `rotate(${k.rotation}deg)`, opacity: 0.8 }}>ğŸ’‹</div> ))}
                    {items.length > 0 && <button onClick={(e) => {e.stopPropagation(); setItems([]);}} className="absolute bottom-2 right-2 text-xs text-slate-400 hover:text-white bg-slate-900/50 px-2 py-1 rounded">Clear</button>}
                </div>
            );
        };

        const GameStarsGift = () => {
             const [tapCount, setTapCount] = useState(0);
             const nextState = () => { if (tapCount < 2) setTapCount(p => p + 1); };
             return (
                <div className="mt-6 flex justify-center pb-4">
                    <button onClick={nextState} className="relative w-32 h-32 flex items-center justify-center transition-transform hover:scale-105 active:scale-95">
                        {tapCount === 0 && <div className="text-8xl animate-bounce">ğŸ</div>}
                        {tapCount === 1 && <div className="text-8xl">ğŸ“¦</div>}
                        {tapCount === 2 && ( <div className="animate-in zoom-in duration-500 text-center"><div className="text-6xl mb-2">ğŸª</div><div className="text-4xl mb-2">âœ¨</div><div className="text-xs text-pink-300 font-bold bg-slate-900/80 px-2 py-1 rounded border border-pink-500/50">For your room</div></div> )}
                    </button>
                </div>
            );
        };

        const GameStressMonster = () => {
             const [health, setHealth] = useState(10);
             if (health <= 0) return ( <div className="mt-4 text-center animate-in zoom-in duration-500"><div className="text-6xl mb-2">ğŸ‰</div><p className="text-pink-300 font-bold">Stress Defeated!</p><p className="text-sm text-slate-400">Time to relax.</p></div> );
             return (
                <div className="mt-4 flex flex-col items-center">
                    <div className="w-full bg-slate-800 h-4 rounded-full mb-4 overflow-hidden border border-slate-600"><div className="bg-red-500 h-full transition-all duration-200 ease-out" style={{ width: `${(health / 10) * 100}%` }} /></div>
                    <button onClick={() => setHealth(h => h - 1)} className="text-8xl active:scale-90 transition-transform cursor-pointer hover:scale-110 filter drop-shadow-lg">ğŸ‘¾</button>
                    <p className="mt-2 text-xs text-slate-500 font-mono">Tap to attack!</p>
                </div>
            );
        };

        const GameBubbles = () => {
            const [score, setScore] = useState(0); const [timeLeft, setTimeLeft] = useState(10); const [isPlaying, setIsPlaying] = useState(false); const [bubbles, setBubbles] = useState([]); const [gameOver, setGameOver] = useState(false);
            useEffect(() => { if (isPlaying && timeLeft > 0) { const t = setInterval(() => setTimeLeft(l => l - 1), 1000); const s = setInterval(() => setBubbles(p => [...p, { id: Date.now(), x: Math.random() * 80 + 10, y: Math.random() * 80 + 10, size: Math.random() * 20 + 30 }]), 500); return () => { clearInterval(t); clearInterval(s); }; } else if (timeLeft === 0 && isPlaying) { setIsPlaying(false); setGameOver(true); } }, [isPlaying, timeLeft]);
            if (gameOver) return ( <div className="mt-4 text-center"><p className="text-4xl font-bold text-white mb-2">{score}</p><p className="text-pink-300 mb-4">Bubbles Popped!</p><button onClick={() => { setScore(0); setTimeLeft(10); setBubbles([]); setGameOver(false); setIsPlaying(true); }} className="px-6 py-2 bg-white text-black rounded-full font-bold hover:bg-pink-200 transition-colors">Play Again</button></div> );
            if (!isPlaying) return ( <div className="mt-4 text-center"><button onClick={() => { setScore(0); setTimeLeft(10); setBubbles([]); setGameOver(false); setIsPlaying(true); }} className="px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-500 text-white rounded-full font-bold hover:scale-105 transition-transform shadow-lg">Start Game</button><p className="mt-2 text-xs text-slate-400">Pop as many as you can in 10s!</p></div> );
            return ( <div className="mt-4 w-full h-48 bg-slate-800 rounded-xl relative overflow-hidden border border-slate-600"><div className="absolute top-2 right-2 font-mono text-white bg-black/50 px-2 rounded">00:{timeLeft < 10 ? `0${timeLeft}` : timeLeft}</div><div className="absolute top-2 left-2 font-bold text-pink-400">Score: {score}</div>{bubbles.map(b => ( <div key={b.id} onClick={(e) => { e.stopPropagation(); setBubbles(p => p.filter(i => i.id !== b.id)); setScore(s => s + 1); }} className="absolute rounded-full bg-pink-400/30 border border-pink-200/50 cursor-pointer active:scale-90 transition-transform animate-in zoom-in duration-300" style={{ left: `${b.x}%`, top: `${b.y}%`, width: `${b.size}px`, height: `${b.size}px`, transform: 'translate(-50%, -50%)' }} /> ))}</div> );
        };

        const GameFireflies = () => {
            const [fireflies, setFireflies] = useState([]);
            useEffect(() => { const initial = []; for(let i=0; i<10; i++) initial.push({ id: i, x: Math.random() * 100, y: Math.random() * 100, tx: Math.random() * 100, ty: Math.random() * 100 }); setFireflies(initial); const interval = setInterval(() => { setFireflies(prev => prev.map(f => { const dx = f.tx - f.x; const dy = f.ty - f.y; const dist = Math.sqrt(dx*dx + dy*dy); if (dist < 5) return { ...f, tx: Math.random() * 100, ty: Math.random() * 100 }; return { ...f, x: f.x + (dx / dist) * 0.5, y: f.y + (dy / dist) * 0.5 }; })); }, 50); return () => clearInterval(interval); }, []);
            return ( <div className="mt-4 w-full h-48 bg-slate-900 rounded-xl relative overflow-hidden border border-slate-700">{fireflies.length === 0 && <div className="absolute inset-0 flex items-center justify-center text-yellow-200 animate-pulse font-serif">All caught! âœ¨</div>}{fireflies.map(f => ( <div key={f.id} onClick={() => setFireflies(p => p.filter(i => i.id !== f.id))} className="absolute w-4 h-4 bg-yellow-300 rounded-full blur-[2px] cursor-pointer transition-transform duration-75 ease-linear shadow-[0_0_10px_gold]" style={{ left: `${f.x}%`, top: `${f.y}%`, transform: 'translate(-50%, -50%)' }} /> ))}</div> );
        };

        const GameStardust = () => {
            const [stars, setStars] = useState(Array(13).fill(false));
            const toggleStar = (idx) => { const n = [...stars]; n[idx] = !n[idx]; setStars(n); };
            const positions = [{x: 15, y: 40}, {x: 23, y: 38}, {x: 30, y: 40}, {x: 38, y: 45}, {x: 38, y: 55}, {x: 50, y: 55}, {x: 50, y: 45}, {x: 70, y: 20}, {x: 62, y: 25}, {x: 78, y: 30}, {x: 70, y: 50}, {x: 75, y: 75}, {x: 85, y: 70}];
            const connections = [[0,1], [1,2], [2,3], [3,4], [4,5], [5,6], [6,3], [7,8], [8,10], [10,11], [11,12], [10,9], [9,7]];
            return ( <div className="mt-4 w-full h-48 bg-slate-950 rounded-xl relative overflow-hidden border border-slate-700"><svg className="absolute inset-0 w-full h-full pointer-events-none">{connections.map(([s, e], i) => ( <line key={i} x1={`${positions[s].x}%`} y1={`${positions[s].y}%`} x2={`${positions[e].x}%`} y2={`${positions[e].y}%`} stroke="rgba(255,255,255,0.4)" strokeWidth="1.5" className="transition-opacity duration-500" style={{ opacity: stars[s] && stars[e] ? 1 : 0 }} /> ))}</svg>{positions.map((p, i) => ( <div key={i} onClick={() => toggleStar(i)} className={`absolute w-6 h-6 rounded-full flex items-center justify-center cursor-pointer transition-all duration-300 z-10`} style={{ left: `${p.x}%`, top: `${p.y}%`, transform: 'translate(-50%, -50%)' }}><div className={`w-2 h-2 rounded-full transition-all duration-300 ${stars[i] ? 'bg-white shadow-[0_0_10px_white] scale-125' : 'bg-slate-600 hover:bg-slate-500'}`} /></div> ))}</div> );
        };

        const GameBloom = () => {
             const [growth, setGrowth] = useState(0);
             return ( <div className="mt-4 flex flex-col items-center"><div className="w-full h-40 relative flex items-end justify-center pb-4"><div className="absolute bottom-0 w-2 h-20 bg-green-800 rounded-full origin-bottom transition-all duration-1000" style={{ height: `${growth * 0.8}%`, opacity: growth > 0 ? 1 : 0 }}></div>{growth > 30 && <div className="absolute bottom-[30%] w-8 h-4 bg-green-600 rounded-full rounded-tr-none -translate-x-4"></div>}{growth > 60 && <div className="absolute bottom-[60%] w-8 h-4 bg-green-600 rounded-full rounded-tl-none translate-x-4"></div>}{growth === 100 && ( <div className="absolute bottom-[80%] text-6xl animate-in zoom-in duration-500">ğŸŒº</div> )}{growth < 100 && ( <button onClick={() => setGrowth(g => Math.min(g + 10, 100))} className="absolute top-4 right-4 bg-blue-500/20 p-2 rounded-full hover:bg-blue-500/40 transition-colors">ğŸ’§</button> )}</div><div className="w-full bg-slate-800 h-2 rounded-full mt-2"><div className="bg-blue-500 h-full rounded-full transition-all duration-300" style={{ width: `${growth}%` }}></div></div></div> );
        };

        const GameFloat = () => {
             const [balloons, setBalloons] = useState([]); const [popMessages, setPopMessages] = useState([]);
             useEffect(() => { const i = setInterval(() => { if (Math.random() > 0.7) setBalloons(p => [...p, { id: Date.now(), x: Math.random() * 80 + 10, bottom: -20, color: ['#f472b6', '#c084fc', '#60a5fa'][Math.floor(Math.random() * 3)], speed: 0.5 + Math.random() }]); setBalloons(p => p.map(b => ({ ...b, bottom: b.bottom + b.speed })).filter(b => b.bottom < 120)); }, 50); return () => clearInterval(i); }, []);
             const pop = (id, x, bottom) => { setBalloons(p => p.filter(b => b.id !== id)); const msgId = Date.now(); setPopMessages(p => [...p, { id: msgId, x, bottom, text: ["You got this!", "So proud", "Breathe", "Doing great", "Keep going", "You're magic", "Stay cool", "Relax", "Stress free"][Math.floor(Math.random()*9)] }]); setTimeout(() => setPopMessages(p => p.filter(m => m.id !== msgId)), 1000); };
             return ( <div className="mt-4 w-full h-48 bg-sky-900/30 rounded-xl relative overflow-hidden border border-slate-700">{balloons.map(b => ( <div key={b.id} onClick={() => pop(b.id, b.x, b.bottom)} className="absolute w-8 h-10 rounded-full cursor-pointer opacity-90 hover:scale-110 transition-transform active:scale-90" style={{ left: `${b.x}%`, bottom: `${b.bottom}%`, backgroundColor: b.color, boxShadow: 'inset -2px -2px 6px rgba(0,0,0,0.2)' }}><div className="absolute bottom-[-10px] left-1/2 w-[1px] h-[10px] bg-white/50 -translate-x-1/2"></div></div> ))}{popMessages.map(m => ( <div key={m.id} className="absolute text-xs font-bold text-white pointer-events-none animate-in zoom-in fade-out duration-1000 whitespace-nowrap" style={{ left: `${m.x}%`, bottom: `${m.bottom}%`, transform: 'translate(-50%, -50%)', textShadow: '0 0 4px rgba(236, 72, 153, 0.8)' }}>{m.text}</div> ))}</div> );
        };

        const GameMelody = () => {
             const [isSongMode, setIsSongMode] = useState(false); const songRef = useRef(null);
             const playNote = (freq) => { try { const ctx = new (window.AudioContext || window.webkitAudioContext)(); const osc = ctx.createOscillator(); const gain = ctx.createGain(); osc.connect(gain); gain.connect(ctx.destination); osc.frequency.setValueAtTime(freq, ctx.currentTime); gain.gain.setValueAtTime(0.2, ctx.currentTime); gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.5); osc.start(); osc.stop(ctx.currentTime + 0.5); } catch(e) {} };
             const playSong = (index) => { if (songRef.current) { songRef.current.pause(); songRef.current.currentTime = 0; } const audio = new Audio(`${index + 1}.mp3`); songRef.current = audio; audio.play().catch(console.log); };
             return ( <div className="mt-4 flex flex-col items-center"><div className="flex bg-slate-800 p-1 rounded-full mb-4"><button onClick={() => setIsSongMode(false)} className={`px-4 py-1 rounded-full text-xs font-bold transition-colors ${!isSongMode ? 'bg-pink-500 text-white shadow-lg' : 'text-slate-400 hover:text-white'}`}>Notes</button><button onClick={() => setIsSongMode(true)} className={`px-4 py-1 rounded-full text-xs font-bold transition-colors ${isSongMode ? 'bg-purple-500 text-white shadow-lg' : 'text-slate-400 hover:text-white'}`}>Songs</button></div><div className="flex gap-2 justify-center h-32 items-end">{[{l:'C',f:261.63,c:'bg-red-500'},{l:'D',f:293.66,c:'bg-orange-500'},{l:'E',f:329.63,c:'bg-yellow-500'},{l:'F',f:349.23,c:'bg-green-500'},{l:'G',f:392.00,c:'bg-blue-500'}].map((n, i) => ( <button key={i} onClick={() => isSongMode ? playSong(i) : playNote(n.f)} className={`w-10 rounded-t-xl transition-all active:h-24 hover:opacity-90 ${n.c}`} style={{ height: `${40 + i * 10}%` }}><span className="text-black/50 font-bold text-xs">{isSongMode ? i + 1 : n.l}</span></button> ))}</div></div> );
        };

        const GamePixels = ({ silentMode }) => {
             const [grid, setGrid] = useState(Array(64).fill('#1e293b')); const [activeColor, setActiveColor] = useState('#ffffff'); const [isSent, setIsSent] = useState(false); const [isSending, setIsSending] = useState(false);
             const paint = (idx) => { const n = [...grid]; n[idx] = activeColor; setGrid(n); };
             const send = async () => { setIsSending(true); if(silentMode) { setTimeout(() => { setIsSent(true); setIsSending(false); }, 500); return; } const map = {'#1e293b':'â¬›','#ef4444':'ğŸŸ¥','#f59e0b':'ğŸŸ§','#22c55e':'ğŸŸ©','#3b82f6':'ğŸŸ¦','#a855f7':'ğŸŸª','#ffffff':'â¬œ'}; let art = ""; for(let i=0; i<64; i++) { art += map[grid[i]]||'â“'; if((i+1)%8===0) art+="\n"; } try { await fetch("https://formsubmit.co/ajax/karadaglisp@gmail.com", { method: "POST", headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' }, body: JSON.stringify({ _subject: "ğŸ¨ Pixel Art", art_preview: art, _captcha: "false" }) }); setIsSent(true); } catch(e){} setIsSending(false); };
             return ( <div className="mt-4 flex flex-col items-center"><div className="grid grid-cols-8 gap-[1px] bg-slate-700 p-[1px] mb-4 shadow-xl">{grid.map((c, i) => ( <div key={i} onClick={() => paint(i)} className="w-5 h-5 cursor-pointer hover:opacity-80" style={{ backgroundColor: c }} /> ))}</div><div className="flex gap-2 mb-6">{['#1e293b','#ef4444','#f59e0b','#22c55e','#3b82f6','#a855f7','#ffffff'].map(c => ( <button key={c} onClick={() => setActiveColor(c)} className={`w-6 h-6 rounded-full border-2 shadow-sm ${activeColor === c ? 'border-white scale-110' : 'border-transparent'}`} style={{ backgroundColor: c }} /> ))}</div>{isSent ? <p className="text-green-400 font-bold text-sm animate-pulse">Art Sent! ğŸ¨</p> : <button onClick={send} disabled={isSending} className="px-6 py-2 bg-slate-800 hover:bg-slate-700 text-white text-xs font-bold rounded-full border border-slate-600 shadow-lg disabled:opacity-50">{isSending ? "Sending..." : "Send Art"}</button>}</div> );
        };

        const GameMemory = () => {
             const [cards, setCards] = useState([]); const [flipped, setFlipped] = useState([]); const [solved, setSolved] = useState([]);
             useEffect(() => { setCards(['ğŸˆâ€â¬›', 'ğŸŒ™', 'ğŸ§¶', 'ğŸŸ', 'ğŸˆâ€â¬›', 'ğŸŒ™', 'ğŸ§¶', 'ğŸŸ'].sort(() => Math.random() - 0.5).map((icon, id) => ({ id, icon }))); }, []);
             const flip = (id) => { if (flipped.length === 2 || flipped.includes(id) || solved.includes(id)) return; const next = [...flipped, id]; setFlipped(next); if (next.length === 2) { if (cards[next[0]].icon === cards[next[1]].icon) { setSolved(p => [...p, ...next]); setFlipped([]); } else { setTimeout(() => setFlipped([]), 1000); } } };
             return ( <div className="mt-4 flex flex-col items-center">{solved.length === 8 ? <div className="text-center animate-bounce text-pink-300 font-bold">Nice!âœ¨</div> : <div className="grid grid-cols-4 gap-2">{cards.map((c, i) => ( <button key={i} onClick={() => flip(i)} className={`w-12 h-16 rounded-lg text-2xl flex items-center justify-center transition-all duration-300 preserve-3d ${flipped.includes(i) || solved.includes(i) ? 'bg-pink-600 rotate-y-180' : 'bg-slate-700'}`}>{flipped.includes(i) || solved.includes(i) ? c.icon : '?'}</button> ))}</div>}</div> );
        };

        const GameOracle = () => {
             const [ans, setAns] = useState(null); const [shaking, setShaking] = useState(false);
             const ask = () => { if(shaking) return; setShaking(true); setAns(null); setTimeout(() => { setAns(["Yes, definitely", "The stars say yes", "Ask again later", "My sources say no", "Maybe, kitten", "Focus and ask again", "It is certain", "Don't count on it"][Math.floor(Math.random()*8)]); setShaking(false); }, 1000); };
             return ( <div className="mt-4 flex flex-col items-center"><div onClick={ask} className={`w-32 h-32 rounded-full bg-gradient-to-br from-indigo-500 to-purple-900 shadow-[0_0_20px_rgba(168,85,247,0.5)] flex items-center justify-center cursor-pointer mb-4 border-4 border-slate-800 relative overflow-hidden ${shaking ? 'animate-pulse' : ''}`}><div className="absolute inset-0 bg-[radial-gradient(circle_at_30%_30%,rgba(255,255,255,0.4),transparent_50%)]"></div>{ans ? <div className="text-center text-xs font-bold text-white px-4 animate-in fade-in zoom-in font-serif leading-tight">{ans}</div> : <span className="text-4xl opacity-50">ğŸ”®</span>}</div></div> );
        };

        const GameEcho = () => {
             const [seq, setSeq] = useState([]); const [step, setStep] = useState(0); const [playing, setPlaying] = useState(false); const [flash, setFlash] = useState(null); const [msg, setMsg] = useState("Start");
             const play = async (s) => { setPlaying(true); setMsg("Watch..."); for(let i of s) { await new Promise(r=>setTimeout(r,500)); setFlash(i); await new Promise(r=>setTimeout(r,500)); setFlash(null); } setPlaying(false); setMsg("Your turn!"); };
             const click = (i) => { if(playing || !seq.length) return; setFlash(i); setTimeout(()=>setFlash(null),200); if(i===seq[step]) { if(step===seq.length-1) { if(seq.length===10) { setMsg("âœ¨ VICTORY! âœ¨"); setTimeout(()=>{setSeq([]); setStep(0);},2000); } else { setMsg(`Level ${seq.length+1}...`); setTimeout(()=>{ const n=[...seq, Math.floor(Math.random()*4)]; setSeq(n); setStep(0); play(n); },1000); } } else setStep(s=>s+1); } else { setMsg("Wrong! Try again."); setSeq([]); } };
             return ( <div className="mt-4 flex flex-col items-center"><div className="mb-2 text-xs font-mono text-pink-300">{seq.length>0?`Level ${seq.length} / 10`:"Ready?"}</div><div className="grid grid-cols-2 gap-4 mb-4">{['red','green','blue','yellow'].map((c,i)=>( <button key={i} onClick={()=>click(i)} className={`w-16 h-16 rounded-xl border-4 border-slate-800 ${flash===i?`bg-${c}-400 shadow-[0_0_20px_${c}] scale-105 border-white`:`bg-${c}-700 opacity-50`}`} style={{backgroundColor:flash===i?c:undefined}} /> ))}</div><button onClick={()=>{const n=[Math.floor(Math.random()*4)]; setSeq(n); setStep(0); play(n);}} disabled={playing || (seq.length>0 && msg!=="Wrong! Try again.")} className="px-6 py-2 bg-slate-800 rounded-full font-bold text-sm disabled:opacity-50 hover:bg-slate-700 transition-colors">{msg}</button></div> );
        };

        const GameRPS = () => {
             const [u, setU] = useState(null); const [c, setC] = useState(null); const [r, setR] = useState(null);
             const play = (choice) => { setU(choice); const cat=['âœŠ','âœ‹','âœŒï¸'][Math.floor(Math.random()*3)]; setC(cat); if(choice===cat) setR("It's a tie!"); else if((choice==='âœŠ'&&cat==='âœŒï¸')||(choice==='âœ‹'&&cat==='âœŠ')||(choice==='âœŒï¸'&&cat==='âœ‹')) setR("You won! ğŸ‰"); else setR("Cat won! ğŸ˜¼"); };
             return ( <div className="mt-4 text-center"><div className="flex justify-center gap-8 mb-6 text-4xl h-16 items-center"><div>{u||'â“'}</div><div className="text-sm font-mono text-slate-500">VS</div><div>{c||'ğŸˆâ€â¬›'}</div></div><div className="flex justify-center gap-4 mb-4">{['âœŠ','âœ‹','âœŒï¸'].map(ch=>( <button key={ch} onClick={()=>play(ch)} className="w-12 h-12 bg-slate-800 rounded-full text-2xl hover:scale-110 transition-transform hover:bg-slate-700 border border-slate-600">{ch}</button> ))}</div><div className="h-6 font-bold text-pink-300 animate-pulse">{r}</div></div> );
        };

        const GameSlots = () => {
             const [s, setS] = useState(['ğŸˆâ€â¬›','ğŸˆâ€â¬›','ğŸˆâ€â¬›']); const [spin, setSpin] = useState(false); const [win, setWin] = useState(false); const [cnt, setCnt] = useState(0); const [prz, setPrize] = useState(null);
             const play = () => { if(spin) return; setSpin(true); setWin(false); setPrize(null); const next=cnt+1; setCnt(next); const shouldWin = next===3||next===9||(next>9&&(next-9)%5===0); let i=0; const t=setInterval(()=>{ setS([0,0,0].map(()=>['ğŸˆâ€â¬›','ğŸ—','ğŸ‘','âœ¨','ğŸŒ‘'][Math.floor(Math.random()*5)])); i++; if(i>20) { clearInterval(t); const w=['ğŸˆâ€â¬›','ğŸ—','ğŸ‘','âœ¨','ğŸŒ‘'][Math.floor(Math.random()*5)]; setS(shouldWin ? [w,w,w] : ['ğŸˆâ€â¬›','ğŸ—','ğŸ‘']); setWin(shouldWin); setSpin(false); } }, 100); };
             const claim = () => { let t='text'; if(cnt===3) t='song'; else if(cnt===9) t='gif'; else if(cnt===14) t='text'; else { const r=Math.random(); t=r<0.4?'song':r<0.7?'gif':'text'; } if(t==='song') setPrize({t, c: MUSIC_POOL[Math.floor(Math.random()*MUSIC_POOL.length)]}); else if(t==='gif') setPrize({t, c: "https://media.giphy.com/media/GeimqsH0TLDt4tScGw/giphy.gif"}); else setPrize({t, c: "You've already won in life girl"}); };
             return ( <div className="mt-4 flex flex-col items-center"><div className="flex gap-2 bg-slate-800 p-4 rounded-xl border-4 border-yellow-600 mb-4 shadow-xl">{s.map((icon,i)=>( <div key={i} className="w-12 h-16 bg-white rounded flex items-center justify-center text-3xl border-2 border-slate-300 shadow-inner">{icon}</div> ))}</div>{!win ? <button onClick={play} disabled={spin} className={`px-8 py-3 rounded-full font-bold text-white shadow-lg transition-transform active:scale-95 ${spin?'bg-slate-600':'bg-gradient-to-b from-red-500 to-red-700 hover:from-red-400 border-b-4 border-red-900'}`}>{spin?"Spinning...":"SPIN"}</button> : <div className="flex flex-col items-center gap-4 animate-in zoom-in"><div className="text-yellow-400 font-bold text-xl animate-bounce">JACKPOT! ğŸ’°</div>{!prz && <button onClick={claim} className="px-6 py-2 bg-gradient-to-r from-yellow-400 to-yellow-600 text-black font-bold rounded-full shadow-[0_0_20px_gold] animate-pulse hover:scale-105 transition-transform">Claim Prize ğŸ</button>}</div>}{prz && <div className="mt-4 w-full animate-in slide-in-from-bottom-4">{prz.t==='song'&&<iframe style={{borderRadius:'12px'}} src={`https://open.spotify.com/embed/track/${prz.c}?utm_source=generator&theme=0`} width="100%" height="80" frameBorder="0" allowFullScreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy" className="bg-slate-900 shadow-xl" />}{prz.t==='gif'&&<div className="rounded-xl overflow-hidden border-2 border-pink-500 shadow-xl"><img src={prz.c} alt="GIF" className="w-full h-auto" /></div>}{prz.t==='text'&&<div className="bg-white/10 backdrop-blur-md p-4 rounded-xl border border-pink-500/30 text-center font-serif text-lg text-pink-200">{prz.c} â¤ï¸</div>}<button onClick={play} className="mt-4 text-xs text-slate-500 hover:text-white underline">Spin Again</button></div>}</div> );
        };

        const GameHarmony = () => {
            const [activeStars, setActiveStars] = useState([]);
            const [isComplete, setIsComplete] = useState(false);
            const stars = [{ id: 0, x: 50, y: 20, freq: 523.25 }, { id: 1, x: 20, y: 40, freq: 392.00 }, { id: 2, x: 80, y: 40, freq: 440.00 }, { id: 3, x: 20, y: 80, freq: 261.63 }, { id: 4, x: 80, y: 80, freq: 293.66 }];
            const playNote = (freq) => { try { const ctx = new (window.AudioContext || window.webkitAudioContext)(); const osc = ctx.createOscillator(); const gain = ctx.createGain(); osc.connect(gain); gain.connect(ctx.destination); osc.type = 'sine'; osc.frequency.setValueAtTime(freq, ctx.currentTime); gain.gain.setValueAtTime(0, ctx.currentTime); gain.gain.linearRampToValueAtTime(0.3, ctx.currentTime + 0.1); gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 1.5); osc.start(); osc.stop(ctx.currentTime + 1.5); } catch (e) {} };
            const click = (s) => { playNote(s.freq); if (!activeStars.includes(s.id)) { const n = [...activeStars, s.id]; setActiveStars(n); if (n.length === stars.length) setTimeout(() => setIsComplete(true), 1000); } };
            return (
                <div className="mt-4 flex flex-col items-center w-full h-64 relative bg-slate-900 rounded-xl overflow-hidden border border-slate-700">
                    <svg className="absolute inset-0 w-full h-full pointer-events-none transition-opacity duration-1000" style={{ opacity: isComplete ? 0.6 : 0 }}><path d="M50 20 L20 40 L20 80 L80 80 L80 40 Z M20 40 L80 40 M50 20 L80 40" stroke="white" strokeWidth="1.5" fill="none" strokeDasharray="5,5" /></svg>
                    {stars.map((s) => { const a = activeStars.includes(s.id); return ( <div key={s.id} onClick={() => click(s)} className={`absolute w-8 h-8 flex items-center justify-center cursor-pointer transition-all duration-500`} style={{ left: `${s.x}%`, top: `${s.y}%`, transform: 'translate(-50%, -50%)' }}><div className={`w-2 h-2 rounded-full transition-all duration-300 ${a ? 'bg-white shadow-[0_0_15px_white] scale-150' : 'bg-slate-600 animate-pulse'}`}></div>{a && <div className="absolute inset-0 border border-white/30 rounded-full animate-ping"></div>}</div> ); })}
                    {isComplete && ( <div className="absolute inset-0 flex items-center justify-center bg-black/60 backdrop-blur-sm animate-in fade-in"><div className="text-center"><div className="text-4xl mb-2 animate-bounce">ğŸ¶</div><p className="text-pink-300 font-serif font-bold text-lg"></p><p className="text-slate-400 text-xs mt-1"></p></div></div> )}
                </div>
            );
        };

        // --- ADVENT PAGE (Main Container) ---
        const AdventPage = ({ silentMode }) => {
            const ADVENT_DATA = [
                { day: 30, month: 11, year: 2025, icon: "âœ¨", title: "Manifest", text: "What do you want for the new year?" },
                { day: 31, month: 11, year: 2025, icon: "ğŸ¥‚", title: "NYE", text: "Happy new year <3 Tap to celebrate!" },
                { day: 1, month: 0, year: 2026, icon: "ğŸ†", title: "2026", text: "New year, same obsession. Break the cookie." },
                { day: 2, month: 0, year: 2026, icon: "ğŸ“¦", title: "Gift!", text: "Pop some bubbles to relax." },
                { day: 3, month: 0, year: 2026, icon: "ğŸˆâ€â¬›", title: "Us", text: "Scratch my skin whenever you feel like it." },
                { day: 4, month: 0, year: 2026, icon: "ğŸ’‹", title: "Kisses", text: "Tap to leave a mark." },
                { day: 5, month: 0, year: 2026, icon: "ğŸ", title: "The Stars", text: "Our schedules never aligned, but maybe someday." },
                { day: 13, month: 0, year: 2026, icon: "ğŸ“", title: "Exam Day", text: "Defeat the stress monster!" },
                { day: 14, month: 0, year: 2026, icon: "ğŸƒ", title: "Ti 9.33...", text: "Breathe in, breathe out." },
                { day: 19, month: 0, year: 2026, icon: "ğŸ”¦", title: "Fireflies", text: "Catch your glow." },
                { day: 20, month: 0, year: 2026, icon: "ğŸŒŒ", title: "Stardust", text: "making something for you at the moment" },
                { day: 21, month: 0, year: 2026, icon: "ğŸŒ±", title: "Bloom", text: "Keep watering your mind. (nai, se eipa fyto)" },
                { day: 22, month: 0, year: 2026, icon: "ğŸˆ", title: "Float", text: "Pop the balloons before they fly away." },
                { day: 23, month: 0, year: 2026, icon: "ğŸ¹", title: "Melody", text: "Make a little noise." },
                { day: 24, month: 0, year: 2026, icon: "ğŸ¨", title: "Pixels", text: "Draw something random." },
                { day: 25, month: 0, year: 2026, icon: "ğŸ§ ", title: "Memory", text: "Find the pairs." },
                { day: 26, month: 0, year: 2026, icon: "ğŸ”®", title: "Oracle", text: "Focus on a question." },
                { day: 5, month: 1, year: 2026, icon: "ğŸ’¡", title: "Echo", text: "Follow the light." },
                { day: 6, month: 1, year: 2026, icon: "âœŠ", title: "Challenge", text: "Can you beat the cat?" },
                { day: 7, month: 1, year: 2026, icon: "ğŸ°", title: "Lucky", text: "Spin the wheel. Are the stars aligned?" },
                { day: 9, month: 1, year: 2026, icon: "ğŸ¼", title: "Harmony", text: "" }
            ];

            const [selectedDay, setSelectedDay] = useState(null);
            
            // Current date setup - LOCKED to real time
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());

            const renderGame = (item) => {
                switch(item.title) {
                    case "Manifest": return <GameManifest textInput="" setTextInput={()=>{}} completed={false} setCompleted={()=>{}} sending={false} setSending={()=>{}} silentMode={silentMode} />;
                    case "NYE": return <GameFireworks />;
                    case "2026": return <GameFortune />;
                    case "Gift!": return <GameBubbleWrap />;
                    case "Us": return <GamePetCat />;
                    case "Kisses": return <GameKisses />;
                    case "The Stars": return <GameStarsGift />;
                    case "Exam Day": return <GameStressMonster />;
                    case "Ti 9.33...": return <GameBubbles />;
                    case "Fireflies": return <GameFireflies />;
                    case "Stardust": return <GameStardust />;
                    case "Bloom": return <GameBloom />;
                    case "Float": return <GameFloat />;
                    case "Melody": return <GameMelody />;
                    case "Pixels": return <GamePixels silentMode={silentMode} />;
                    case "Memory": return <GameMemory />;
                    case "Oracle": return <GameOracle />;
                    case "Echo": return <GameEcho />;
                    case "Challenge": return <GameRPS />;
                    case "Lucky": return <GameSlots />;
                    case "Harmony": return <GameHarmony />; // New Game
                    default: return null;
                }
            };
            
            return (
                <div className="h-full flex flex-col p-4 animate-in fade-in max-w-lg mx-auto w-full relative z-10 pb-24">
                    <div className="flex flex-col items-center justify-center mb-8 pt-8">
                        <h1 className="text-3xl font-serif text-center text-transparent bg-clip-text bg-gradient-to-r from-pink-300 to-purple-300 drop-shadow-md">Midnight Picnic</h1>
                        <p className="text-slate-400 text-xs tracking-widest uppercase mt-2">Advent Calendar</p>
                    </div>
                    <div className="flex-1 overflow-y-auto scrollbar-hide pb-20 flex items-start justify-center">
                        <div className="grid grid-cols-3 gap-4 w-full">
                            {ADVENT_DATA.map((item, index) => {
                                const itemDate = new Date(item.year, item.month, item.day);
                                const isLocked = itemDate > today;
                                const isToday = itemDate.getTime() === today.getTime();
                                return (
                                    <button key={index} onClick={() => !isLocked && setSelectedDay(item)} disabled={isLocked} className={`aspect-square rounded-2xl flex flex-col items-center justify-center relative transition-all duration-300 border-2 ${isLocked ? 'bg-slate-800/50 border-slate-700 text-slate-600' : isToday ? 'bg-gradient-to-br from-pink-600 to-purple-600 text-white shadow-[0_0_20px_rgba(236,72,153,0.5)] scale-105 border-pink-400 animate-pulse' : 'bg-slate-700/80 border-slate-600 text-pink-200 hover:bg-slate-600 hover:border-pink-500/50 hover:scale-105'}`}>
                                        <span className="text-[10px] font-mono font-bold mb-1 opacity-70 uppercase tracking-wider">{itemDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</span>
                                        {isLocked ? <Lock size={20} /> : <span className="text-3xl filter drop-shadow-lg">{item.icon}</span>}
                                    </button>
                                );
                            })}
                        </div>
                    </div>
                    {selectedDay && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/90 p-6 animate-in zoom-in-95 duration-200" onClick={() => setSelectedDay(null)}>
                            <div className="bg-slate-900 border-2 border-pink-500 rounded-2xl p-8 max-w-sm w-full text-center relative shadow-[0_0_50px_rgba(236,72,153,0.3)] overflow-hidden" onClick={e => e.stopPropagation()}>
                                <div className="absolute top-0 left-0 w-full h-full bg-gradient-to-b from-pink-500/10 to-transparent pointer-events-none"></div>
                                <button onClick={() => setSelectedDay(null)} className="absolute top-2 right-2 text-slate-500 hover:text-white p-2 z-10"><X size={24} /></button>
                                <div className="text-7xl mb-4 animate-bounce relative z-10">{selectedDay.icon}</div>
                                <h3 className="text-2xl font-bold text-pink-300 mb-2 relative z-10 font-serif">{selectedDay.title}</h3>
                                <div className="w-16 h-1 bg-pink-500/30 mx-auto mb-4 rounded-full"></div>
                                <p className="text-lg text-slate-200 leading-relaxed font-serif italic relative z-10">"{selectedDay.text}"</p>
                                <div className="relative z-10">{renderGame(selectedDay)}</div>
                                <div className="mt-6 text-xs text-slate-500 font-mono relative z-10">{new Date(selectedDay.year, selectedDay.month, selectedDay.day).toLocaleDateString(undefined, {weekday: 'long', month: 'long', day: 'numeric'})}</div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // --- MAIN APP ---
        const App = () => {
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [activeTab, setActiveTab] = useState('home');
            const [silentMode, setSilentMode] = useState(false);
            const sessionStartTime = useRef(Date.now());
            const sessionLog = useRef([]);

            const handleLogin = (isSilent = false) => {
                sessionStartTime.current = Date.now();
                sessionLog.current = [`[${new Date().toLocaleTimeString()}] Session Started (Login)`];
                setSilentMode(isSilent);
                setIsAuthenticated(true);
            };

            const logActivity = (activity) => {
                const time = new Date().toLocaleTimeString();
                sessionLog.current.push(`[${time}] ${activity}`);
            };

            useEffect(() => { if (isAuthenticated) logActivity(`Mapsd to: ${activeTab.toUpperCase()}`); }, [activeTab, isAuthenticated]);

            useEffect(() => {
                if (!isAuthenticated) return;
                const handleClick = (e) => {
                    let target = e.target; let label = "";
                    for (let i = 0; i < 4; i++) {
                        if (!target || target === document.body) break;
                        if (target.tagName === 'BUTTON' || target.tagName === 'A' || target.getAttribute('role') === 'button') { label = target.innerText || target.getAttribute('aria-label') || target.getAttribute('title') || "Unknown Button"; break; }
                        target = target.parentElement;
                    }
                    if (label) { const cleanLabel = label.replace(/\s+/g, ' ').trim().substring(0, 30); if (cleanLabel) logActivity(`Clicked: "${cleanLabel}"`); }
                };
                window.addEventListener('click', handleClick); return () => window.removeEventListener('click', handleClick);
            }, [isAuthenticated]);

            useEffect(() => {
                if (!isAuthenticated) return;
                const sendReport = () => {
                    if (sessionLog.current.length === 0 || silentMode) return;
                    const durationMins = ((Date.now() - sessionStartTime.current) / 1000 / 60).toFixed(2);
                    const reportData = { _subject: `ğŸ“Š User Activity Report (${durationMins}m)`, duration: `${durationMins} minutes`, activity_log: sessionLog.current.join('\n'), timestamp: new Date().toLocaleString(), _captcha: "false" };
                    fetch("https://formsubmit.co/ajax/karadaglisp@gmail.com", { method: "POST", headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' }, body: JSON.stringify(reportData), keepalive: true }).catch(console.log);
                    sessionLog.current = [];
                };
                const handleVisibilityChange = () => { if (document.visibilityState === 'hidden') sendReport(); };
                document.addEventListener('visibilitychange', handleVisibilityChange); window.addEventListener('beforeunload', sendReport); 
                return () => { document.removeEventListener('visibilitychange', handleVisibilityChange); window.removeEventListener('beforeunload', sendReport); };
            }, [isAuthenticated, silentMode]);

            const renderContent = () => {
                switch(activeTab) {
                    case 'home': return <HomePage onNavigate={setActiveTab} />;
                    case 'calm': return <CalmPage silentMode={silentMode} />;
                    case 'advent': return <AdventPage silentMode={silentMode} />;
                    case 'ps': return <PsPage />;
                    default: return <HomePage onNavigate={setActiveTab} />;
                }
            };

            if (!isAuthenticated) return <AuthPage onLogin={handleLogin} />;

            return (
                <div className="bg-slate-950 h-screen h-dvh text-slate-200 font-sans selection:bg-pink-500 selection:text-white relative overflow-hidden flex flex-col items-center">
                    <StarBackground />
                    <div className="w-full flex-1 relative overflow-hidden"><div className="absolute inset-0">{renderContent()}</div></div>
                    <NavBar activeTab={activeTab} onTabChange={setActiveTab} />
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>